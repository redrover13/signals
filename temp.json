{
  "version": "3.0.0",
  "description": "Optimized MCP Server Configuration for Signals Project",
  "schema": "https://schemas.signals.dev/mcp-config/v3.0.0",
  "metadata": {
    "lastUpdated": "2025-08-28T00:00:00Z",
    "configVersion": "3.0.0",
    "maintainer": "Signals DevOps Team",
    "optimization": "Reduced from 1047 to ~250 lines using inheritance and templates"
  },

  "defaults": {
    "env": {
      "GCP_PROJECT_ID": "${GCP_PROJECT_ID:-signals-1}",
      "GCP_REGION": "${GCP_REGION:-us-central1}",
      "WIF_PROVIDER": "${WIF_PROVIDER}",
      "WIF_SERVICE_ACCOUNT": "${WIF_SERVICE_ACCOUNT}",
      "NODE_ENV": "${NODE_ENV:-development}",
      "LOG_LEVEL": "${LOG_LEVEL:-info}",
      "MCP_DEFAULT_TIMEOUT": "${MCP_DEFAULT_TIMEOUT:-15000}"
    },
    "connection": {
      "timeout": "${MCP_DEFAULT_TIMEOUT}",
      "retry": {
        "attempts": 2,
        "delay": 500,
        "backoff": "linear"
      }
    },
    "healthCheck": {
      "interval": 30000,
      "failureThreshold": 2
    }
  },

  "serverTemplates": {
    "gcp-service": {
      "auth": {
        "type": "wif",
        "serviceAccount": "${WIF_SERVICE_ACCOUNT}"
      },
      "connection": {
        "endpoint": "https://mcp.googleapis.com/{service}/sse",
        "timeout": "${MCP_DEFAULT_TIMEOUT}"
      }
    },
    "external-api": {
      "auth": {
        "type": "secret-manager",
        "secretName": "{service}-api-key-${NODE_ENV}"
      },
      "connection": {
        "timeout": "${MCP_DEFAULT_TIMEOUT}"
      }
    },
    "reference-server": {
      "connection": {
        "timeout": "${MCP_DEFAULT_TIMEOUT}"
      }
    }
  },

  "servers": {
    "github": {
      "extends": "external-api",
      "connection": {
        "endpoint": "https://api.github.com/graphql"
      }
    },
    "codacy": {
      "extends": "external-api",
      "connection": {
        "timeout": 20000
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "codacy-token-${NODE_ENV}"
      }
    },
    "databases": {
      "extends": "gcp-service",
      "options": {
        "bigqueryProjectId": "${GCP_PROJECT_ID}",
        "datasets": ["analytics_${NODE_ENV}", "signals_${NODE_ENV}", "events_${NODE_ENV}"]
      }
    },
    "google-maps": {
      "extends": "external-api",
      "auth": {
        "type": "env",
        "envName": "GOOGLE_MAPS_API_KEY"
      },
      "connection": {
        "endpoint": "${GOOGLE_MAPS_URL:-https://mcp.googleapis.com/maps/sse}"
      }
    },
    "google-search": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_SEARCH_URL:-https://mcp.googleapis.com/search/sse}"
      }
    },
    "qdrant": {
      "extends": "external-api",
      "connection": {
        "endpoint": "${QDRANT_URL:-https://mcp.qdrant.tech/sse}"
      },
      "auth": {
        "type": "env",
        "envName": "QDRANT_API_KEY"
      }
    },
    "exa": {
      "extends": "external-api"
    },
    "toolbox": {
      "extends": "gcp-service",
      "connection": {
        "timeout": 30000
      },
      "options": {
        "toolsConfigSecret": "toolbox-tools-config-${NODE_ENV}"
      }
    },
    "cloudrun": {
      "extends": "gcp-service",
      "connection": {
        "timeout": 30000
      },
      "options": {
        "invokerServiceAccount": "${WIF_SERVICE_ACCOUNT}"
      }
    },
    "semgrep": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${SEMGREP_URL:-https://mcp.semgrep.ai/sse}",
        "timeout": 10000
      }
    },
    "nx-mcp": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${NX_MCP_URL:-https://mcp.nx.app/sse}",
        "timeout": 10000
      }
    },
    "filesystem": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_FILESYSTEM_URL:-https://mcp.googleapis.com/filesystem/sse}"
      }
    },
    "typescript": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${TSSERVER_URL:-http://localhost:3000}",
        "timeout": 10000
      },
      "options": {
        "preferences": {
          "includeCompletionsForModuleExports": true,
          "includeCompletionsForImportStatements": true,
          "allowIncompleteCompletions": true
        }
      }
    },
    "eslint": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${ESLINT_URL:-http://localhost:3001}",
        "timeout": 15000
      },
      "options": {
        "validateOnType": true,
        "validateOnSave": true,
        "rules": {
          "@typescript-eslint/no-unused-vars": "error",
          "@typescript-eslint/explicit-function-return-type": "warn"
        }
      }
    },
    "json": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${JSON_SERVER_URL:-http://localhost:3002}",
        "timeout": 5000
      },
      "options": {
        "schemas": {
          "package.json": "https://json.schemastore.org/package.json",
          "tsconfig.json": "https://json.schemastore.org/tsconfig.json"
        }
      }
    }
  },
    "development": {
      "enabledServerGroups": ["core-services", "development-tools", "gcp-services", "external-apis", "analysis-tools"],
      "overrides": {
        "global": {
          "logging": {
            "level": "debug",
            "includeRequestResponse": true
          },
          "security": {
            "enableTLS": false,
            "validateCertificates": false
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 10000
            }
          },
          "codacy": {
            "connection": {
              "timeout": 20000
            }
          }
        }
      }
    },

    "staging": {
      "enabledServerGroups": ["core-services", "gcp-services", "external-apis", "analysis-tools"],
      "overrides": {
        "global": {
          "logging": {
            "level": "info",
            "includeRequestResponse": false
          },
          "security": {
            "enableTLS": true,
            "validateCertificates": true
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 15000
            }
          }
        }
      }
    },

    "production": {
      "enabledServerGroups": ["core-services", "gcp-services", "external-apis"],
      "overrides": {
        "global": {
          "logging": {
            "level": "warn",
            "includeRequestResponse": false
          },
          "security": {
            "enableTLS": true,
            "validateCertificates": true
          },
          "metrics": {
            "enabled": true,
            "samplingRate": 0.1
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 20000
            }
          }
        }
      }
    }
