{
  "version": "3.1.0",
  "description": "Enterprise-Grade MCP Server Configuration for Signals Project with Enhanced AI Tool Integration",
  "schema": "https://schemas.signals.dev/mcp-config/v3.1.0",
  "metadata": {
    "lastUpdated": "2025-08-28T00:00:00Z",
    "configVersion": "3.1.0",
    "maintainer": "Signals DevOps Team",
    "optimization": "Enhanced with enterprise features, AI tool integrations, comprehensive error handling, and advanced monitoring",
    "integrations": ["codacy", "coderabbit", "gemini", "copilot", "github", "nx-cloud"]
  },

  "global": {
    "timeouts": {
      "default": "${MCP_DEFAULT_TIMEOUT:-15000}",
      "long": "${MCP_LONG_TIMEOUT:-30000}",
      "short": "${MCP_SHORT_TIMEOUT:-5000}"
    },
    "retry": {
      "default": {
        "attempts": 3,
        "delay": 1000,
        "backoff": "exponential",
        "maxDelay": 10000
      }
    },
    "security": {
      "tlsVersion": "1.3",
      "validateCertificates": true,
      "allowInsecure": false
    },
    "monitoring": {
      "enabled": true,
      "metricsInterval": "${METRICS_INTERVAL:-60000}",
      "healthCheckInterval": "${HEALTH_CHECK_INTERVAL:-30000}",
      "tracing": {
        "enabled": true,
        "samplingRate": "${TRACE_SAMPLING_RATE:-0.1}"
      }
    }
  },

  "defaults": {
    "env": {
      "GCP_PROJECT_ID": "${GCP_PROJECT_ID:-signals-1}",
      "GCP_REGION": "${GCP_REGION:-us-central1}",
      "WIF_PROVIDER": "${WIF_PROVIDER}",
      "WIF_SERVICE_ACCOUNT": "${WIF_SERVICE_ACCOUNT}",
      "NODE_ENV": "${NODE_ENV:-development}",
      "LOG_LEVEL": "${LOG_LEVEL:-info}",
      "MCP_DEFAULT_TIMEOUT": "${MCP_DEFAULT_TIMEOUT:-15000}"
    },
    "connection": {
      "timeout": "${MCP_DEFAULT_TIMEOUT}",
      "keepAlive": true,
      "compression": "gzip",
      "retry": {
        "attempts": 2,
        "delay": 500,
        "backoff": "linear"
      }
    },
    "healthCheck": {
      "enabled": true,
      "interval": "${HEALTH_CHECK_INTERVAL:-30000}",
      "failureThreshold": 3
    }
  },

  "serverTemplates": {
    "base-service": {
      "connection": {
        "keepAlive": true,
        "compression": "gzip",
        "timeout": "${MCP_DEFAULT_TIMEOUT}"
      },
      "healthCheck": {
        "enabled": true,
        "interval": "${HEALTH_CHECK_INTERVAL:-30000}",
        "failureThreshold": 3
      },
      "retry": {
        "attempts": 3,
        "delay": 1000,
        "backoff": "exponential"
      },
      "monitoring": {
        "metrics": true,
        "tracing": true
      }
    },
    "gcp-service": {
      "extends": "base-service",
      "auth": {
        "type": "wif",
        "serviceAccount": "${WIF_SERVICE_ACCOUNT}",
        "scopes": ["https://www.googleapis.com/auth/cloud-platform"]
      },
      "connection": {
        "endpoint": "https://mcp.googleapis.com/{service}/sse"
      },
      "options": {
        "projectId": "${GCP_PROJECT_ID}",
        "region": "${GCP_REGION}"
      }
    },
    "external-api": {
      "extends": "base-service",
      "auth": {
        "type": "secret-manager",
        "secretName": "{service}-api-key-${NODE_ENV}"
      },
      "rateLimiting": {
        "enabled": true,
        "requestsPerSecond": 50,
        "burstSize": 100
      }
    },
    "reference-server": {
      "extends": "base-service",
      "connection": {
        "protocol": "http"
      },
      "development": {
        "hotReload": true,
        "debugMode": true
      }
    }
  },

  "servers": {
    "github": {
      "extends": "external-api",
      "connection": {
        "endpoint": "https://api.github.com/graphql",
        "timeout": "${GITHUB_TIMEOUT:-15000}"
      },
      "options": {
        "owner": "${GITHUB_OWNER}",
        "repo": "${GITHUB_REPO}",
        "rateLimiting": {
          "requestsPerHour": 5000
        }
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "github-token-${NODE_ENV}",
        "scopes": ["repo", "read:org", "read:user"]
      }
    },
    "codacy": {
      "extends": "external-api",
      "connection": {
        "endpoint": "https://app.codacy.com/api/v3",
        "timeout": "${CODACY_TIMEOUT:-20000}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "codacy-token-${NODE_ENV}"
      },
      "options": {
        "organizationProvider": "gh",
        "rateLimiting": {
          "requestsPerMinute": 100
        },
        "analysis": {
          "autoTrigger": true,
          "supportedTools": ["eslint", "semgrep", "trivy", "sonarqube"],
          "qualityGates": {
            "coverage": 80,
            "duplication": 5,
            "complexity": "B"
          }
        }
      }
    },
    "coderabbit": {
      "extends": "external-api",
      "connection": {
        "endpoint": "https://api.coderabbit.ai/v1",
        "timeout": "${CODERABBIT_TIMEOUT:-15000}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "coderabbit-token-${NODE_ENV}"
      },
      "options": {
        "review": {
          "autoReview": true,
          "reviewStyle": "comprehensive",
          "focusAreas": ["security", "performance", "maintainability", "best-practices"]
        },
        "integrations": {
          "github": true,
          "slack": true,
          "jira": false
        },
        "rateLimiting": {
          "requestsPerHour": 1000
        }
      }
    },
    "gemini": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GEMINI_URL:-https://generativelanguage.googleapis.com/v1beta}",
        "timeout": "${GEMINI_TIMEOUT:-30000}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "gemini-api-key-${NODE_ENV}"
      },
      "options": {
        "model": "${GEMINI_MODEL:-gemini-1.5-pro}",
        "temperature": 0.7,
        "maxTokens": 8192,
        "safetySettings": {
          "enabled": true,
          "blockUnsafe": true
        },
        "rateLimiting": {
          "requestsPerMinute": 60,
          "requestsPerDay": 1440
        }
      }
    },
    "copilot": {
      "extends": "external-api",
      "connection": {
        "endpoint": "https://api.github.com/copilot",
        "timeout": "${COPILOT_TIMEOUT:-15000}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "copilot-token-${NODE_ENV}",
        "scopes": ["read:user", "read:org", "copilot:read"]
      },
      "options": {
        "model": "gpt-4",
        "contextWindow": 128000,
        "features": {
          "codeCompletion": true,
          "codeReview": true,
          "codeExplanation": true,
          "testGeneration": true
        },
        "integrations": {
          "vscode": true,
          "github": true,
          "jetbrains": false
        },
        "rateLimiting": {
          "requestsPerHour": 500
        }
      }
    },
    "databases": {
      "extends": "gcp-service",
      "connection": {
        "timeout": "${DATABASE_TIMEOUT:-30000}"
      },
      "options": {
        "bigqueryProjectId": "${GCP_PROJECT_ID}",
        "datasets": [
          "analytics_${NODE_ENV}", 
          "signals_${NODE_ENV}", 
          "events_${NODE_ENV}"
        ],
        "connectionPool": {
          "maxConnections": 50,
          "minConnections": 10,
          "idleTimeout": 300000
        }
      }
    },
    "google-maps": {
      "extends": "external-api",
      "connection": {
        "endpoint": "${GOOGLE_MAPS_URL:-https://mcp.googleapis.com/maps/sse}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "google-maps-api-key-${NODE_ENV}"
      },
      "options": {
        "rateLimiting": {
          "requestsPerSecond": 50,
          "requestsPerDay": 100000
        }
      }
    },
    "google-search": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_SEARCH_URL:-https://mcp.googleapis.com/search/sse}"
      },
      "options": {
        "customSearchEngineId": "${GOOGLE_CSE_ID}",
        "rateLimiting": {
          "requestsPerSecond": 10,
          "requestsPerDay": 10000
        }
      }
    },
    "google-postgres": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_POSTGRES_URL:-https://mcp.googleapis.com/postgres/sse}",
        "timeout": "${POSTGRES_TIMEOUT:-30000}"
      },
      "options": {
        "connectionPool": {
          "maxConnections": 20,
          "minConnections": 5,
          "idleTimeout": 300000
        },
        "ssl": {
          "enabled": true,
          "rejectUnauthorized": true
        }
      }
    },
    "google-analytics": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_ANALYTICS_URL:-https://mcp.googleapis.com/analytics/sse}"
      },
      "options": {
        "propertyId": "${GA_PROPERTY_ID}",
        "viewId": "${GA_VIEW_ID}"
      }
    },
    "google-storage": {
      "extends": "gcp-service", 
      "connection": {
        "endpoint": "${GOOGLE_STORAGE_URL:-https://mcp.googleapis.com/storage/sse}"
      },
      "options": {
        "defaultBucket": "${GCS_DEFAULT_BUCKET}",
        "region": "${GCP_REGION}"
      }
    },
    "qdrant": {
      "extends": "external-api",
      "connection": {
        "endpoint": "${QDRANT_URL:-https://mcp.qdrant.tech/sse}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "qdrant-api-key-${NODE_ENV}"
      },
      "options": {
        "collection": "${QDRANT_COLLECTION:-signals}",
        "vectorSize": 1536
      }
    },
    "exa": {
      "extends": "external-api",
      "connection": {
        "endpoint": "${EXA_URL:-https://api.exa.ai/search}"
      },
      "auth": {
        "type": "secret-manager",
        "secretName": "exa-api-key-${NODE_ENV}"
      }
    },
    "toolbox": {
      "extends": "gcp-service",
      "connection": {
        "timeout": "${TOOLBOX_TIMEOUT:-30000}"
      },
      "options": {
        "toolsConfigSecret": "toolbox-tools-config-${NODE_ENV}",
        "enabledTools": ["calculator", "weather", "translator"]
      }
    },
    "cloudrun": {
      "extends": "gcp-service",
      "connection": {
        "timeout": "${CLOUDRUN_TIMEOUT:-30000}"
      },
      "options": {
        "invokerServiceAccount": "${WIF_SERVICE_ACCOUNT}",
        "region": "${GCP_REGION}"
      }
    },
    "semgrep": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${SEMGREP_URL:-https://mcp.semgrep.ai/sse}",
        "timeout": "${SEMGREP_TIMEOUT:-10000}"
      },
      "options": {
        "rulesets": ["auto", "security", "performance"],
        "severity": ["ERROR", "WARNING"]
      }
    },
    "nx-mcp": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${NX_MCP_URL:-https://mcp.nx.app/sse}",
        "timeout": "${NX_TIMEOUT:-10000}"
      },
      "options": {
        "workspaceRoot": "${NX_WORKSPACE_ROOT:-./}",
        "cacheDirectory": "${NX_CACHE_DIR:-.nx/cache}"
      }
    },
    "filesystem": {
      "extends": "gcp-service",
      "connection": {
        "endpoint": "${GOOGLE_FILESYSTEM_URL:-https://mcp.googleapis.com/filesystem/sse}"
      },
      "options": {
        "allowedPaths": ["./src", "./libs", "./apps"],
        "maxFileSize": "10MB"
      }
    },
    "typescript": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${TSSERVER_URL:-http://localhost:3000}",
        "timeout": "${TYPESCRIPT_TIMEOUT:-10000}"
      },
      "options": {
        "preferences": {
          "includeCompletionsForModuleExports": true,
          "includeCompletionsForImportStatements": true,
          "allowIncompleteCompletions": true
        },
        "compilerOptions": {
          "strict": true,
          "noImplicitAny": true
        }
      }
    },
    "eslint": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${ESLINT_URL:-http://localhost:3001}",
        "timeout": "${ESLINT_TIMEOUT:-15000}"
      },
      "options": {
        "validateOnType": true,
        "validateOnSave": true,
        "configFile": ".eslintrc.json",
        "rules": {
          "@typescript-eslint/no-unused-vars": "error",
          "@typescript-eslint/explicit-function-return-type": "warn"
        }
      }
    },
    "json": {
      "extends": "reference-server",
      "connection": {
        "endpoint": "${JSON_SERVER_URL:-http://localhost:3002}",
        "timeout": "${JSON_TIMEOUT:-5000}"
      },
      "options": {
        "schemas": {
          "package.json": "https://json.schemastore.org/package.json",
          "tsconfig.json": "https://json.schemastore.org/tsconfig.json",
          "mcp.json": "https://schemas.signals.dev/mcp-config/v3.0.0"
        },
        "validateOnSave": true
      }
    }
  },

  "environments": {
    "base-environment": {
      "global": {
        "monitoring": {
          "enabled": true,
          "healthCheckInterval": 30000
        },
        "security": {
          "tlsVersion": "1.3",
          "validateCertificates": true
        }
      }
    },
    "development": {
      "extends": "base-environment",
      "enabledServerGroups": ["core-services", "development-tools", "gcp-services", "external-apis", "analysis-tools", "ai-tools"],
      "features": {
        "debugMode": true,
        "hotReload": true,
        "mockExternalAPIs": false,
        "verboseLogging": true
      },
      "overrides": {
        "global": {
          "logging": {
            "level": "debug",
            "includeRequestResponse": true
          },
          "security": {
            "allowInsecure": true,
            "validateCertificates": false
          },
          "monitoring": {
            "metricsInterval": 10000
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 10000
            }
          },
          "codacy": {
            "connection": {
              "timeout": 20000
            }
          }
        }
      }
    },
    "staging": {
      "extends": "base-environment",
      "enabledServerGroups": ["core-services", "gcp-services", "external-apis", "analysis-tools", "ai-tools"],
      "features": {
        "debugMode": false,
        "hotReload": false,
        "mockExternalAPIs": false,
        "verboseLogging": false
      },
      "overrides": {
        "global": {
          "logging": {
            "level": "info",
            "includeRequestResponse": false
          },
          "security": {
            "enableTLS": true,
            "validateCertificates": true
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 15000
            }
          }
        }
      }
    },
    "production": {
      "extends": "base-environment",
      "enabledServerGroups": ["core-services", "gcp-services", "external-apis"],
      "features": {
        "debugMode": false,
        "hotReload": false,
        "mockExternalAPIs": false,
        "verboseLogging": false
      },
      "overrides": {
        "global": {
          "logging": {
            "level": "warn",
            "includeRequestResponse": false
          },
          "security": {
            "enableTLS": true,
            "validateCertificates": true
          },
          "metrics": {
            "enabled": true,
            "samplingRate": 0.1
          },
          "monitoring": {
            "alerting": true,
            "metricsInterval": 60000
          }
        },
        "servers": {
          "github": {
            "connection": {
              "timeout": 20000
            }
          }
        }
      }
    }
  },

  "serverGroups": {
    "core-services": {
      "description": "Essential services for basic functionality",
      "servers": ["github", "codacy", "coderabbit", "gemini", "copilot", "semgrep", "nx-mcp"],
      "healthCheck": {
        "enabled": true,
        "criticalServices": ["github", "codacy", "gemini"]
      }
    },
    "development-tools": {
      "description": "Tools used during development and debugging",
      "servers": ["exa", "toolbox", "typescript", "eslint", "json"],
      "loadBalancing": {
        "strategy": "round-robin"
      }
    },
    "gcp-services": {
      "description": "Google Cloud Platform services",
      "servers": ["databases", "cloudrun", "filesystem", "google-postgres", "google-analytics", "google-storage"],
      "circuitBreaker": {
        "enabled": true,
        "failureThreshold": 5,
        "recoveryTimeout": 30000
      }
    },
    "external-apis": {
      "description": "Third-party API integrations",
      "servers": ["google-maps", "google-search", "qdrant", "exa"],
      "rateLimiting": {
        "enabled": true,
        "globalLimit": 1000
      }
    },
    "analysis-tools": {
      "description": "Code analysis and security tools",
      "servers": ["semgrep"],
      "caching": {
        "enabled": true,
        "ttl": 3600000
      }
    },
    "ai-tools": {
      "description": "AI-powered development and review tools",
      "servers": ["coderabbit", "gemini", "copilot"],
      "circuitBreaker": {
        "enabled": true,
        "failureThreshold": 3,
        "recoveryTimeout": 60000
      },
      "rateLimiting": {
        "enabled": true,
        "globalLimit": 100
      }
    }
  },

  "circuitBreaker": {
    "enabled": true,
    "failureThreshold": 5,
    "recoveryTimeout": 30000,
    "halfOpenMaxCalls": 3,
    "servers": {
      "github": {
        "failureThreshold": 3
      },
      "external-apis": {
        "failureThreshold": 5
      }
    }
  },

  "caching": {
    "enabled": true,
    "defaultTTL": 300000,
    "strategies": {
      "github": {
        "type": "redis",
        "ttl": 600000,
        "keyPattern": "github:{endpoint}:{hash}"
      },
      "google-search": {
        "type": "memory", 
        "ttl": 1800000,
        "maxSize": 1000
      },
      "semgrep": {
        "type": "file",
        "ttl": 3600000,
        "directory": ".cache/semgrep"
      }
    }
  },

  "monitoring": {
    "metrics": {
      "enabled": true,
      "exporters": ["prometheus", "datadog", "cloud-monitoring"],
      "customMetrics": {
        "request_duration": {
          "type": "histogram",
          "buckets": [0.1, 0.5, 1.0, 2.5, 5.0, 10.0]
        },
        "request_count": {
          "type": "counter",
          "labels": ["server", "method", "status", "ai_tool"]
        },
        "active_connections": {
          "type": "gauge"
        },
        "ai_tool_usage": {
          "type": "counter",
          "labels": ["tool", "operation", "success"]
        },
        "code_quality_score": {
          "type": "gauge",
          "labels": ["tool", "metric"]
        }
      }
    },
    "tracing": {
      "enabled": true,
      "sampler": {
        "type": "probabilistic",
        "param": "${TRACE_SAMPLING_RATE:-0.1}"
      },
      "exporters": ["jaeger", "zipkin", "cloud-trace"]
    },
    "healthChecks": {
      "startup": {
        "enabled": true,
        "timeout": 30000
      },
      "readiness": {
        "enabled": true,
        "interval": 10000
      },
      "liveness": {
        "enabled": true,
        "interval": 30000
      }
    },
    "alerting": {
      "enabled": true,
      "channels": ["slack", "email", "pagerduty"],
      "rules": {
        "high_error_rate": {
          "condition": "error_rate > 0.05",
          "duration": "5m",
          "severity": "critical"
        },
        "high_latency": {
          "condition": "p95_latency > 5000",
          "duration": "2m",
          "severity": "warning"
        },
        "ai_tool_failure": {
          "condition": "ai_tool_error_rate > 0.1",
          "duration": "10m",
          "severity": "warning"
        },
        "code_quality_degradation": {
          "condition": "code_quality_score < 7.0",
          "duration": "1h",
          "severity": "info"
        }
      }
    }
  },

  "validation": {
    "schema": {
      "enabled": true,
      "strict": true,
      "validateOnLoad": true
    },
    "environmentVariables": {
      "required": [
        "GCP_PROJECT_ID", 
        "WIF_PROVIDER", 
        "WIF_SERVICE_ACCOUNT"
      ],
      "optional": [
        "NODE_ENV",
        "GCP_REGION",
        "GITHUB_OWNER",
        "GITHUB_REPO",
        "MCP_DEFAULT_TIMEOUT",
        "MCP_LONG_TIMEOUT",
        "MCP_SHORT_TIMEOUT",
        "HEALTH_CHECK_INTERVAL",
        "METRICS_INTERVAL",
        "TRACE_SAMPLING_RATE",
        "GITHUB_TIMEOUT",
        "CODACY_TIMEOUT",
        "CODERABBIT_TIMEOUT",
        "GEMINI_TIMEOUT",
        "COPILOT_TIMEOUT",
        "DATABASE_TIMEOUT",
        "POSTGRES_TIMEOUT",
        "TOOLBOX_TIMEOUT",
        "CLOUDRUN_TIMEOUT",
        "SEMGREP_TIMEOUT",
        "NX_TIMEOUT",
        "TYPESCRIPT_TIMEOUT",
        "ESLINT_TIMEOUT",
        "JSON_TIMEOUT",
        "SEMGREP_URL",
        "NX_MCP_URL",
        "GOOGLE_FILESYSTEM_URL",
        "GOOGLE_POSTGRES_URL",
        "GOOGLE_ANALYTICS_URL",
        "GOOGLE_STORAGE_URL",
        "GOOGLE_MAPS_URL",
        "GOOGLE_SEARCH_URL",
        "QDRANT_URL",
        "EXA_URL",
        "TSSERVER_URL",
        "ESLINT_URL",
        "JSON_SERVER_URL",
        "GA_PROPERTY_ID",
        "GA_VIEW_ID",
        "GCS_DEFAULT_BUCKET",
        "GOOGLE_CSE_ID",
        "QDRANT_COLLECTION",
        "NX_WORKSPACE_ROOT",
        "NX_CACHE_DIR",
        "GEMINI_URL",
        "GEMINI_MODEL"
      ]
    },
    "servers": {
      "validateConnections": true,
      "validateAuth": true,
      "validateTemplates": true
    }
  },

  "performance": {
    "connectionPooling": {
      "enabled": true,
      "defaultMaxConnections": 50,
      "defaultMinConnections": 5
    },
    "batching": {
      "enabled": true,
      "maxBatchSize": 100,
      "batchTimeout": 1000
    },
    "compression": {
      "enabled": true,
      "algorithm": "gzip",
      "level": 6
    }
  },

  "security": {
    "secretRotation": {
      "enabled": true,
      "interval": "24h",
      "services": ["github", "codacy", "coderabbit", "gemini", "copilot", "google-maps", "qdrant", "exa"]
    },
    "networkSecurity": {
      "allowedOrigins": ["*.signals.dev", "localhost"],
      "rateLimiting": {
        "enabled": true,
        "windowSize": "1m",
        "maxRequests": 1000
      }
    },
    "audit": {
      "enabled": true,
      "logLevel": "info",
      "includeRequestBodies": false
    },
    "aiToolSecurity": {
      "enabled": true,
      "contentFiltering": {
        "enabled": true,
        "blockSensitiveData": true,
        "allowedDomains": ["github.com", "codacy.com", "coderabbit.ai", "googleapis.com"]
      },
      "usageMonitoring": {
        "enabled": true,
        "alertThreshold": 1000,
        "dailyLimit": 50000
      },
      "dataPrivacy": {
        "gdprCompliant": true,
        "dataRetention": "90d",
        "anonymizeLogs": true
      }
    }
  }
}