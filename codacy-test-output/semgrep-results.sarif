{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "invocations": [
        {
          "executionSuccessful": true,
          "toolExecutionNotifications": [
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/monitoring.yml:1:\n (approximate error location; error nearby after) error calling parser: mapping values are not allowed in this context character 0 position 0 returned: 0"
              }
            },
            {
              "descriptor": {
                "id": "Syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Syntax error at line apps/agents/Dockerfile:3:\n `\\nARG USER_ID=1000\nARG GROUP_ID=1000\n\nRUN groupadd -g ${GROUP_ID} appuser \\\n    \u0026\u0026 useradd -u ${USER_ID} -g appuser -s /bin/bash -m appuser\n\n\r\n# Set the working directory in the container\r\nWORKDIR /usr/src/app\r\n\r\n# Copy package.json and pnpm-lock.yaml to the working directory\r\nCOPY package.json pnpm-lock.yaml ./\r\n\r\n# Install dependencies using pnpm\r\nRUN npm install -g pnpm \u0026\u0026 pnpm install\r\n\r\n# Copy the rest of the application's source code\r\nCOPY . .\r\n\r\n# Build the agents application\r\nRUN pnpm nx build agents\r\n\r\n# Expose the port the app runs on\r\nEXPOSE 3000\r\n\r\n# Start the agents application\r\nUSER appuser\nCMD [\"node\", \"dist/apps/agents/main.js\"]` was unexpected"
              }
            },
            {
              "descriptor": {
                "id": "Lexical error"
              },
              "level": "warning",
              "message": {
                "text": "Lexical error at line .kilocode/mcp.json:1:\n unrecognised symbol, in token rule:\\"
              }
            },
            {
              "descriptor": {
                "id": "Syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Syntax error at line apps/api/Dockerfile:3:\n `\\nARG USER_ID=1000\nARG GROUP_ID=1000\n\nRUN groupadd -g ${GROUP_ID} appuser \\\n    \u0026\u0026 useradd -u ${USER_ID} -g appuser -s /bin/bash -m appuser\n\n\r\n# Set the working directory in the container\r\nWORKDIR /usr/src/app\r\n\r\n# Copy package.json and pnpm-lock.yaml to the working directory\r\nCOPY package.json pnpm-lock.yaml ./\r\n\r\n# Install dependencies using pnpm\r\nRUN npm install -g pnpm \u0026\u0026 pnpm install --prod\r\n\r\n# Copy the rest of the application's source code\r\nCOPY . .\r\n\r\n# Build the api application\r\nRUN pnpm nx build api\r\n\r\n# Expose the port the app runs on\r\nEXPOSE 3000\r\n\r\n# Start the agents application\r\nUSER appuser\nCMD [\"node\", \"dist/apps/api/main.js\"]` was unexpected"
              }
            },
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/performance-benchmark.yml:55:\n (approximate error location; error nearby after) error calling parser: could not find expected ':' character 0 position 0 returned: 0"
              }
            },
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/codeql.yml:85:\n (approximate error location; error nearby after) error calling parser: mapping values are not allowed in this context character 0 position 0 returned: 0"
              }
            },
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/multi-env-test.yml:151:\n (approximate error location; error nearby after) error calling parser: could not find expected ':' character 0 position 0 returned: 0"
              }
            },
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/license-compliance.yml:104:\n (approximate error location; error nearby after) error calling parser: could not find expected ':' character 0 position 0 returned: 0"
              }
            },
            {
              "descriptor": {
                "id": "Other syntax error"
              },
              "level": "warning",
              "message": {
                "text": "Other syntax error at line .github/workflows/ci.yml:64:\n (approximate error location; error nearby after) error calling parser: could not find expected ':' character 0 position 0 returned: 0"
              }
            }
          ]
        }
      ],
      "results": [
        {
          "fingerprints": {
            "matchBasedId/v1": "cb1248c8afa718bb10fb91d74ddc1b209f5a689491803384ddb45cdbc3b71d9a583fbc47299d28d297242d564523adaea78863fc335353979b27541f780c982a_0"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/container-security.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 47,
                  "endLine": 80,
                  "snippet": {
                    "text": "        uses: aquasecurity/trivy-action@master"
                  },
                  "startColumn": 9,
                  "startLine": 80
                }
              }
            }
          ],
          "message": {
            "text": "An action sourced from a third-party repository on GitHub is not pinned to a full length commit SHA. Pinning an action to a full length commit SHA is currently the only way to use an action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload."
          },
          "properties": {},
          "ruleId": "codacy.tools-configs.yaml.github-actions.security.third-party-action-not-pinned-to-commit-sha.third-party-action-not-pinned-to-commit-sha"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "cb1248c8afa718bb10fb91d74ddc1b209f5a689491803384ddb45cdbc3b71d9a583fbc47299d28d297242d564523adaea78863fc335353979b27541f780c982a_1"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": ".github/workflows/container-security.yml",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 47,
                  "endLine": 95,
                  "snippet": {
                    "text": "        uses: aquasecurity/trivy-action@master"
                  },
                  "startColumn": 9,
                  "startLine": 95
                }
              }
            }
          ],
          "message": {
            "text": "An action sourced from a third-party repository on GitHub is not pinned to a full length commit SHA. Pinning an action to a full length commit SHA is currently the only way to use an action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload."
          },
          "properties": {},
          "ruleId": "codacy.tools-configs.yaml.github-actions.security.third-party-action-not-pinned-to-commit-sha.third-party-action-not-pinned-to-commit-sha"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "02c36375e407895d71ab397e3be0cfeaf985d0f12ea255fd8ffe305e67d6b0ed4e1bbc7a22ffc44ae90f0e033a65ca0435d60931ed41b4cafdc2ad0b3b4a6eac_0"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "apps/api/src/routes/search.ts",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 35,
                  "endLine": 62,
                  "snippet": {
                    "text": "        return reply.send(response);"
                  },
                  "startColumn": 27,
                  "startLine": 62
                }
              }
            }
          ],
          "message": {
            "text": "Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML."
          },
          "properties": {},
          "ruleId": "codacy.tools-configs.javascript.express.security.audit.xss.direct-response-write.direct-response-write"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "cfb114caa77d1049270e7692a9628c1ac43182d0b9b606708680a612308ac3a8898db66211fe0b8b43faff11fb13147366b4f2f73c8dd5b21342e1259a17de94_0"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "infra/terraform/vertex-agents/main.tf",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 2,
                  "endLine": 82,
                  "snippet": {
                    "text": "resource \"google_storage_bucket\" \"agent_artifacts\" {\n  name     = \"${var.project_id}-agent-artifacts\"\n  location = var.region\n\n  uniform_bucket_level_access = true\n  \n  versioning {\n    enabled = true\n  }\n\n  lifecycle_rule {\n    condition {\n      age = 90\n    }\n    action {\n      type = \"Delete\"\n    }\n  }\n\n  labels = {\n    environment = var.environment\n    managed_by  = \"terraform\"\n  }\n}"
                  },
                  "startColumn": 1,
                  "startLine": 59
                }
              }
            }
          ],
          "message": {
            "text": "Ensure bucket logs access."
          },
          "properties": {},
          "ruleId": "codacy.tools-configs.terraform.gcp.security.gcp-cloud-storage-logging.gcp-cloud-storage-logging"
        }
      ],
      "tool": {
        "driver": {
          "name": "Semgrep OSS",
          "rules": null,
          "semanticVersion": "1.78.0"
        }
      }
    }
  ],
  "version": "2.1.0"
}